import { Vulnerability } from '../types';
import { findOrThrow } from '../utils/object';
import { VULNERABILITIES } from '../bridge-constants';

/** Board Vulnerability from NS perspective */
export const BOARD_TO_VULNERABILITY: Record<number, Vulnerability> = {
	1: Vulnerability.NvNv,
	2: Vulnerability.VNv,
	3: Vulnerability.NvV,
	4: Vulnerability.VV,
	5: Vulnerability.VNv,
	6: Vulnerability.NvV,
	7: Vulnerability.VV,
	8: Vulnerability.NvNv,
	9: Vulnerability.NvV,
	10: Vulnerability.VV,
	11: Vulnerability.NvNv,
	12: Vulnerability.VNv,
	13: Vulnerability.VV,
	14: Vulnerability.NvNv,
	15: Vulnerability.VNv,
	0: Vulnerability.NvV,
};

/**
 * Calculates the vulnerability of the board from NS perspective
 * @param boardNumber Number of board
 * @returns Vulnerability of player on the specified board
 */
export function calculateBoardVulnerability(
	boardNumber: number
): Vulnerability {
	const board = boardNumber % VULNERABILITIES;
	return findOrThrow<number, Vulnerability>(
		BOARD_TO_VULNERABILITY,
		board,
		`Failed to calculate vulnerability of board number ${boardNumber}`
	);
}
